!--------------------------------------------------
!- Pentominos for Commodore Computers
!- By Jim Butterfield, Compute! May 1984
!-
!- Copied and pasted into CBM prg Studio 
!- on 5th September 2015
!- A.B.Sayuti H.M.Saman
!--------------------------------------------------
100 PRINT CHR$(142) "{clear}{right*5}PENTOMINOS{down}"
110 DATA I,2
120 DATA 0,1,0,2,0,3,0,4
130 DATA 1,0,2,0,3,0,4,0
140 DATA X,1
150 DATA 1,-1,1,0,2,0,1,1
160 DATA V,4
170 DATA 0,1,0,2,1,0,2,0
180 DATA 0,1,0,2,1,2,2,2
190 DATA 1,0,2,0,2,1,2,2
200 DATA 1,0,2,0,2,-1,2,-2
210 DATA T,4
220 DATA 0,1,0,2,1,1,2,1
230 DATA 1,0,1,1,2,0,1,2
240 DATA 1,0,2,0,1,-1,1,-2
250 DATA 2,-1,2,0,2,1,1,0
260 DATA W,4
270 DATA 0,1,1,1,1,2,2,2
280 DATA 1,0,1,1,2,1,2,2
290 DATA 0,1,1,-1,1,0,2,-1
300 DATA 1,-1,1,0,2,-2,2,-1
310 DATA U,4
320 DATA 0,2,1,0,1,1,1,2
330 DATA 2,0,0,1,1,1,2,1
340 DATA 0,1,1,0,2,0,2,1
350 DATA 1,0,0,1,0,2,1,2
360 DATA F,8
370 DATA 0,1,1,-1,1,0,2,0
380 DATA 1,-1,2,-1,1,0,1,1
390 DATA 1,-1,1,0,1,1,2,1
400 DATA 1,-1,1,0,2,0,2,1
410 DATA 0,1,1,1,1,2,2,1
420 DATA 1,0,1,1,2,1,1,2
430 DATA 1,0,1,1,2,-1,2,0
440 DATA 1,-2,1,-1,2,-1,1,0
450 DATA L,8
460 DATA 1,0,2,0,3,0,3,1
470 DATA 0,1,0,2,0,3,1,3
480 DATA 1,-3,1,-2,1,-1,1,0
490 DATA 1,0,2,0,3,0,3,-1
500 DATA 1,0,2,0,3,0,0,1
510 DATA 0,1,0,2,0,3,1,0
520 DATA 0,1,1,1,2,1,3,1
530 DATA 1,0,1,1,1,2,1,3
540 DATA Y,8
550 DATA 0,1,0,2,0,3,1,1
560 DATA 1,0,2,0,3,0,1,1
570 DATA 1,-1,1,0,1,1,1,2
580 DATA 1,-1,1,0,2,0,3,0
590 DATA 0,1,0,2,0,3,1,2
600 DATA 1,0,2,0,3,0,2,1
610 DATA 1,-2,1,-1,1,0,1,1
620 DATA 1,0,2,0,3,0,2,-1
630 DATA Z,4
640 DATA 0,1,1,1,2,1,2,2
650 DATA 1,0,1,1,1,2,2,2
660 DATA 1,-2,1,-1,1,0,2,-2
670 DATA 2,-1,1,0,2,0,0,1
680 DATA P,8
690 DATA 0,1,1,0,1,1,2,0
700 DATA 1,0,0,1,1,1,0,2
710 DATA 0,1,1,0,1,1,1,2
720 DATA 1,0,0,1,1,1,2,1
730 DATA 1,-1,1,0,2,-1,2,0
740 DATA 1,-1,1,0,0,1,1,1
750 DATA 0,1,0,2,1,1,1,2
760 DATA 1,0,2,0,1,1,2,1
770 DATA R,8
780 DATA 0,1,0,2,1,2,1,3
790 DATA 1,0,2,0,2,1,3,1
800 DATA 1,-1,1,0,2,-1,3,-1
810 DATA 1,-1,1,0,0,1,0,2
820 DATA 0,1,1,1,1,2,1,3
830 DATA 1,0,1,1,2,1,3,1
840 DATA 1,0,2,-1,2,0,3,-1
850 DATA 1,-2,1,-1,1,0,0,1
860 DATA A,0
870 V$ = "{home}{down*13}"
880 H$ = "{right*23}"
1000 DIM X(63,4), Y(63,4), P(64), P$(13), S(13), T(13), B(6,20)
1001 DIM X1(5),Y1(5), X2(12), Y2(12), U(12)
1010 READ P$,N: IF N=0 GOTO 1070
1020 T = T+1: P$(T) = P$: S(T) = V+1 
1030 FOR J=V+1 TO V+N: P(J)=T 
1040 FOR K=0 TO 3: READ X(J,K), Y(J,K): NEXT K,J 
1050 V=V+N: PRINT P$;
1060 GOTO 1010
1070 PRINTLEFT$(V$,5);: PRINT"CHOOSE: {DOWN}" 
1080 FOR J=3 TO 6:PRINT J;"BY";60/J;"{DOWN}": NEXT J
1090 INPUT "SELECT 3 THRU 6";W1
1100 IF W1<3 OR W1>6 OR W1<>INT(W1) GOTO 1070
1110 W2=60/W1
1120 PRINT "{clear}" 
2000 REM FIND NEW SPACE TO FILL
2010 GOSUB 3000: P=J: GOSUB 3200: IF X1>W2 GOTO 2170
2020 REM GET A NEW PIECE
2030 T(P)=S(P)
2040 PRINT "{HOME}";P$(P);"{DOWN*11}"
2050 REM TRY FITTING PIECE 
2060 C$=P$(P): X1(0)=X1: Y1(0)=Y1: FOR J=1 TO 4 
2070 X=X(T(P),J-1)+X1:Y=Y(T(P),J-1)+Y1:X1(J)=X:Y1(J)=Y 
2080 IF X<1 OR Y<1 OR X>W2 OR Y>W1 GOTO 2260 
2090 IF B(Y,X)<>0 GOTO 2260
2100 NEXT J
2110 REM IT FITS - PUT PIECE IN PLACE
2120 B=P:FOR J=0 TO 4 
2130 X=X1(J):Y=Y1(J):GOSUB 3500 
2140 NEXT J 
2150 X2(P)=X1:Y2(P)=Y1:P1=P1+1:U(P1)=P:GOTO 2010
2160 REM BOARD FILLED :rem 197
2170 PRINT "{HOME}  SOLUTION" ;: END 
2180 REM UNDRAW LAST ONE :rem 150
2190 P=U(P1) :U(P1)=0: P1 = P1-1: IF P1<0 THEN PRINT"THAT'S ALL":END
2200 B=0:X=X2(P):Y=Y2(P):C$=" ":GOSUB 3500
2210 X1=X:Y1=Y:FOR J=1 TO 4
2220 X=X(T(P),J-1)+X1:Y=Y(T(P),J-1)+Y1:X1(J)=X:Y1(J)=Y 
2230 GOSUB 3500 
2240 NEXT J
2250 REM ROTATE THE PIECE 
2260 T(P)=T(P)+1:IF P(T(P))=P GOTO 2060 
2270 REM GIVE UP ON PIECE 
2280 T(P)=0 
2290 REM LOOK FOR NEW PIECE 
2300 P=P+1:IF P>12 GOTO 2190 
2310 IF T(P)<>0 GOTO 2300 
2320 GOTO 2030 
3000 FOR J=1 TO 12: IF T(J)<>0 THEN NEXT J
3010 RETURN
3200 FOR X1=1 TO W2: FOR Y1=1 TO W1
3210 IF B(Y1,X1)=0 GOTO 3230 
3220 NEXT Y1,X1 
3230 RETURN 
3500 PRINT LEFT$(V$,Y+2);LEFT$(H$,X);C$:B(Y,X)=B 
3510 RETURN 